"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[492],{8492:function(e,t,a){a.d(t,{e:function(){return d}});var l=a(7437),r=a(2265),s=a(6334),n=a(9356),i=a(4602);function d(e){let{projectId:t,pageId:a,initialData:d,onSave:o,onCancel:c}=e,[x,u]=(0,r.useState)((null==d?void 0:d.title)||""),[m,g]=(0,r.useState)((null==d?void 0:d.slug)||""),[p,h]=(0,r.useState)(()=>{if(null==d?void 0:d.content)try{return Array.isArray(d.content)?d.content:[{id:"block-1",type:"paragraph",content:""}]}catch(e){}return[{id:"block-1",type:"paragraph",content:""}]}),[v,b]=(0,r.useState)((null==d?void 0:d.metaTitle)||""),[y,j]=(0,r.useState)((null==d?void 0:d.metaDescription)||""),[f,N]=(0,r.useState)((null==d?void 0:d.keywords)||[]),[w,k]=(0,r.useState)((null==d?void 0:d.published)||!1),[C,S]=(0,r.useState)(!1),[P,E]=(0,r.useState)(!1),[T,D]=(0,r.useState)(!1),[z,L]=(0,r.useState)(null),[q,H]=(0,r.useState)(!1),I=(0,n.p)(),M=(0,r.useRef)(null);(0,r.useEffect)(()=>{x&&!a&&g(x.toLowerCase().replace(/[^a-z0-9\s-]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-").replace(/^-|-$/g,""))},[x,a]);let A=()=>"block-".concat(Date.now(),"-").concat(Math.random().toString(36).substr(2,9)),F=(e,t)=>{let a={id:A(),type:e,content:"",metadata:"heading"===e?{level:2}:void 0};if(t){let e=p.findIndex(e=>e.id===t),l=[...p];l.splice(e+1,0,a),h(l)}else h([...p,a]);L(a.id)},O=(e,t)=>{h(p.map(a=>a.id===e?{...a,...t}:a))},_=e=>{if(1===p.length){O(e,{content:""});return}let t=p.findIndex(t=>t.id===e),a=p.filter(t=>t.id!==e);h(a),t>0?L(a[t-1].id):a.length>0&&L(a[0].id)},B=(e,t)=>{let a=p.findIndex(t=>t.id===e);if("up"===t&&0===a||"down"===t&&a===p.length-1)return;let l=[...p],r="up"===t?a-1:a+1;[l[a],l[r]]=[l[r],l[a]],h(l)},U=async()=>{if(!x.trim()){I.error("Validation Error","Page title is required");return}if(!m.trim()){I.error("Validation Error","Page slug is required");return}S(!0);try{let e={title:x.trim(),slug:m.trim(),content:p,metaTitle:v.trim()||void 0,metaDescription:y.trim()||void 0,keywords:f.filter(e=>e.trim()),published:w},l=a?"/api/projects/".concat(t,"/pages/").concat(a):"/api/projects/".concat(t,"/pages"),r=a?"PUT":"POST",s=await fetch(l,{method:r,headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),n=await s.json();if(!s.ok)throw Error(n.error||"Failed to save page");I.success("Success",a?"Page updated successfully":"Page created successfully"),null==o||o(n.data)}catch(e){console.error("Save error:",e),I.error("Save failed",e instanceof Error?e.message:"Unknown error occurred")}finally{S(!1)}},K=e=>{e.trim()&&!f.includes(e.trim())&&N([...f,e.trim()])},R=e=>{N(f.filter((t,a)=>a!==e))};return(0,l.jsxs)("div",{className:"h-full flex flex-col",children:[(0,l.jsxs)("div",{className:"border-b border-gray-200 p-4 flex items-center justify-between",children:[(0,l.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,l.jsx)("h2",{className:"text-lg font-medium",children:a?"Edit Page":"Create New Page"}),(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,l.jsx)("button",{onClick:()=>H(!q),className:"px-3 py-1 text-sm rounded ".concat(q?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-700"),children:q?"✏️ Edit":"\uD83D\uDC41️ Preview"}),(0,l.jsx)("button",{onClick:()=>E(!P),className:"px-3 py-1 text-sm rounded ".concat(P?"bg-green-100 text-green-700":"bg-gray-100 text-gray-700"),children:"SEO"})]})]}),(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,l.jsxs)("label",{className:"flex items-center space-x-2",children:[(0,l.jsx)("input",{type:"checkbox",checked:w,onChange:e=>k(e.target.checked),className:"rounded"}),(0,l.jsx)("span",{className:"text-sm",children:"Published"})]}),c&&(0,l.jsx)(s.z,{variant:"outline",onClick:c,children:"Cancel"}),(0,l.jsx)(s.z,{onClick:U,disabled:C,children:C?"Saving...":"Save Page"})]})]}),(0,l.jsxs)("div",{className:"flex-1 flex overflow-hidden",children:[(0,l.jsxs)("div",{className:"flex-1 flex flex-col",children:[(0,l.jsxs)("div",{className:"border-b border-gray-200 p-4 space-y-3",children:[(0,l.jsx)("input",{type:"text",value:x,onChange:e=>u(e.target.value),placeholder:"Page title",className:"w-full text-2xl font-bold border-none outline-none"}),(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,l.jsx)("span",{className:"text-sm text-gray-500",children:"URL:"}),(0,l.jsxs)("span",{className:"text-sm text-gray-400",children:["/",t,"/"]}),(0,l.jsx)("input",{type:"text",value:m,onChange:e=>g(e.target.value),placeholder:"page-slug",className:"text-sm border-b border-gray-300 outline-none focus:border-blue-500"})]})]}),(0,l.jsx)("div",{className:"flex-1 overflow-y-auto p-4",children:q?(0,l.jsx)("div",{className:"max-w-4xl mx-auto",children:(0,l.jsxs)("div",{className:"prose max-w-none",children:[(0,l.jsx)("h1",{children:x}),p.map(e=>{var t,a,r,s;switch(e.type){case"heading":let n="h".concat((null===(t=e.metadata)||void 0===t?void 0:t.level)||2);return(0,l.jsx)(n,{children:e.content},e.id);case"paragraph":return(0,l.jsx)("p",{children:e.content},e.id);case"image":return(0,l.jsxs)("figure",{children:[(null===(a=e.metadata)||void 0===a?void 0:a.src)&&(0,l.jsx)("img",{src:e.metadata.src,alt:e.metadata.alt||e.content}),e.content&&(0,l.jsx)("figcaption",{children:e.content})]},e.id);case"list":let i=(null===(r=e.metadata)||void 0===r?void 0:r.listType)==="ordered"?"ol":"ul",d=e.content.split("\n").filter(e=>e.trim());return(0,l.jsx)(i,{children:d.map((e,t)=>(0,l.jsx)("li",{children:e.replace(/^[•\-\*]\s*/,"").replace(/^\d+\.\s*/,"")},t))},e.id);case"quote":return(0,l.jsx)("blockquote",{children:e.content},e.id);case"code":return(0,l.jsx)("pre",{children:(0,l.jsx)("code",{className:(null===(s=e.metadata)||void 0===s?void 0:s.language)?"language-".concat(e.metadata.language):"",children:e.content})},e.id);case"divider":return(0,l.jsx)("hr",{},e.id);default:return null}})]})}):(0,l.jsxs)("div",{ref:M,className:"max-w-4xl mx-auto",children:[p.map(e=>{var t,a,r,s,n,i,d,o;let c=z===e.id;return(0,l.jsxs)("div",{className:"relative group border rounded-lg p-3 mb-2 transition-all ".concat(c?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"),onClick:()=>L(e.id),children:[(0,l.jsxs)("div",{className:"absolute -left-2 top-2 flex flex-col space-y-1 opacity-0 group-hover:opacity-100 transition-opacity ".concat(c?"opacity-100":""),children:[(0,l.jsx)("button",{onClick:t=>{t.stopPropagation(),B(e.id,"up")},className:"w-6 h-6 bg-gray-100 hover:bg-gray-200 rounded text-xs flex items-center justify-center",title:"Move up",children:"↑"}),(0,l.jsx)("button",{onClick:t=>{t.stopPropagation(),B(e.id,"down")},className:"w-6 h-6 bg-gray-100 hover:bg-gray-200 rounded text-xs flex items-center justify-center",title:"Move down",children:"↓"}),(0,l.jsx)("button",{onClick:t=>{t.stopPropagation(),_(e.id)},className:"w-6 h-6 bg-red-100 hover:bg-red-200 text-red-600 rounded text-xs flex items-center justify-center",title:"Delete block",children:"\xd7"})]}),"heading"===e.type&&(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)("div",{className:"flex items-center space-x-2",children:(0,l.jsxs)("select",{value:(null===(t=e.metadata)||void 0===t?void 0:t.level)||2,onChange:t=>O(e.id,{metadata:{...e.metadata,level:parseInt(t.target.value)}}),className:"text-sm border rounded px-2 py-1",children:[(0,l.jsx)("option",{value:1,children:"H1"}),(0,l.jsx)("option",{value:2,children:"H2"}),(0,l.jsx)("option",{value:3,children:"H3"}),(0,l.jsx)("option",{value:4,children:"H4"}),(0,l.jsx)("option",{value:5,children:"H5"}),(0,l.jsx)("option",{value:6,children:"H6"})]})}),(0,l.jsx)("input",{type:"text",value:e.content,onChange:t=>O(e.id,{content:t.target.value}),placeholder:"Enter heading text...",className:"w-full border-none outline-none bg-transparent font-bold ".concat((null===(a=e.metadata)||void 0===a?void 0:a.level)===1?"text-3xl":(null===(r=e.metadata)||void 0===r?void 0:r.level)===2?"text-2xl":(null===(s=e.metadata)||void 0===s?void 0:s.level)===3?"text-xl":(null===(n=e.metadata)||void 0===n?void 0:n.level)===4?"text-lg":"text-base")})]}),"paragraph"===e.type&&(0,l.jsx)("textarea",{value:e.content,onChange:t=>O(e.id,{content:t.target.value}),placeholder:"Start writing...",className:"w-full border-none outline-none bg-transparent resize-none min-h-[60px]",style:{overflow:"hidden"},onInput:e=>{let t=e.target;t.style.height="auto",t.style.height="".concat(t.scrollHeight,"px")}}),"image"===e.type&&(0,l.jsxs)("div",{className:"space-y-2",children:[(null===(i=e.metadata)||void 0===i?void 0:i.src)?(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsx)("img",{src:e.metadata.src,alt:e.metadata.alt||e.content,className:"max-w-full h-auto rounded"}),(0,l.jsx)("button",{onClick:()=>O(e.id,{metadata:{...e.metadata,src:void 0}}),className:"absolute top-2 right-2 bg-red-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-sm",children:"\xd7"})]}):(0,l.jsx)("button",{onClick:()=>{L(e.id),D(!0)},className:"w-full h-32 border-2 border-dashed border-gray-300 rounded-lg flex items-center justify-center text-gray-500 hover:border-gray-400",children:"\uD83D\uDCF7 Click to add image"}),(0,l.jsx)("input",{type:"text",value:e.content,onChange:t=>O(e.id,{content:t.target.value}),placeholder:"Image caption (optional)",className:"w-full border-none outline-none bg-transparent text-sm text-gray-600"})]}),"list"===e.type&&(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)("div",{className:"flex items-center space-x-2",children:(0,l.jsxs)("select",{value:(null===(d=e.metadata)||void 0===d?void 0:d.listType)||"unordered",onChange:t=>O(e.id,{metadata:{...e.metadata,listType:t.target.value}}),className:"text-sm border rounded px-2 py-1",children:[(0,l.jsx)("option",{value:"unordered",children:"Bullet List"}),(0,l.jsx)("option",{value:"ordered",children:"Numbered List"})]})}),(0,l.jsx)("textarea",{value:e.content,onChange:t=>O(e.id,{content:t.target.value}),placeholder:"• List item 1 • List item 2 • List item 3",className:"w-full border-none outline-none bg-transparent resize-none min-h-[80px]"})]}),"quote"===e.type&&(0,l.jsx)("blockquote",{className:"border-l-4 border-gray-300 pl-4",children:(0,l.jsx)("textarea",{value:e.content,onChange:t=>O(e.id,{content:t.target.value}),placeholder:"Enter quote text...",className:"w-full border-none outline-none bg-transparent resize-none min-h-[60px] italic"})}),"code"===e.type&&(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)("input",{type:"text",value:(null===(o=e.metadata)||void 0===o?void 0:o.language)||"",onChange:t=>O(e.id,{metadata:{...e.metadata,language:t.target.value}}),placeholder:"Language (optional)",className:"text-sm border rounded px-2 py-1"}),(0,l.jsx)("textarea",{value:e.content,onChange:t=>O(e.id,{content:t.target.value}),placeholder:"Enter code...",className:"w-full border-none outline-none bg-gray-100 font-mono text-sm p-2 rounded resize-none min-h-[120px]"})]}),"divider"===e.type&&(0,l.jsx)("hr",{className:"border-gray-300"}),c&&(0,l.jsxs)("div",{className:"mt-2 flex flex-wrap gap-1",children:[(0,l.jsx)("button",{onClick:()=>F("paragraph",e.id),className:"text-xs bg-gray-100 hover:bg-gray-200 px-2 py-1 rounded",children:"+ Text"}),(0,l.jsx)("button",{onClick:()=>F("heading",e.id),className:"text-xs bg-gray-100 hover:bg-gray-200 px-2 py-1 rounded",children:"+ Heading"}),(0,l.jsx)("button",{onClick:()=>F("image",e.id),className:"text-xs bg-gray-100 hover:bg-gray-200 px-2 py-1 rounded",children:"+ Image"}),(0,l.jsx)("button",{onClick:()=>F("list",e.id),className:"text-xs bg-gray-100 hover:bg-gray-200 px-2 py-1 rounded",children:"+ List"}),(0,l.jsx)("button",{onClick:()=>F("quote",e.id),className:"text-xs bg-gray-100 hover:bg-gray-200 px-2 py-1 rounded",children:"+ Quote"}),(0,l.jsx)("button",{onClick:()=>F("code",e.id),className:"text-xs bg-gray-100 hover:bg-gray-200 px-2 py-1 rounded",children:"+ Code"}),(0,l.jsx)("button",{onClick:()=>F("divider",e.id),className:"text-xs bg-gray-100 hover:bg-gray-200 px-2 py-1 rounded",children:"+ Divider"})]})]},e.id)}),0===p.length&&(0,l.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,l.jsx)("p",{children:"Start writing your page content"}),(0,l.jsx)(s.z,{onClick:()=>F("paragraph"),className:"mt-2",children:"Add First Block"})]})]})})]}),P&&(0,l.jsxs)("div",{className:"w-80 border-l border-gray-200 p-4 overflow-y-auto",children:[(0,l.jsx)("h3",{className:"font-medium mb-4",children:"SEO Settings"}),(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Meta Title"}),(0,l.jsx)("input",{type:"text",value:v,onChange:e=>b(e.target.value),placeholder:"Custom title for search engines",className:"w-full border border-gray-300 rounded px-3 py-2 text-sm"}),(0,l.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:[v.length,"/60 characters"]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Meta Description"}),(0,l.jsx)("textarea",{value:y,onChange:e=>j(e.target.value),placeholder:"Brief description for search results",rows:3,className:"w-full border border-gray-300 rounded px-3 py-2 text-sm"}),(0,l.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:[y.length,"/160 characters"]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Keywords"}),(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)("input",{type:"text",placeholder:"Add keyword and press Enter",className:"w-full border border-gray-300 rounded px-3 py-2 text-sm",onKeyPress:e=>{"Enter"===e.key&&(K(e.currentTarget.value),e.currentTarget.value="")}}),(0,l.jsx)("div",{className:"flex flex-wrap gap-1",children:f.map((e,t)=>(0,l.jsxs)("span",{className:"inline-flex items-center bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded",children:[e,(0,l.jsx)("button",{onClick:()=>R(t),className:"ml-1 text-blue-600 hover:text-blue-800",children:"\xd7"})]},t))})]})]})]})]})]}),T&&(0,l.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,l.jsxs)("div",{className:"bg-white rounded-lg w-full max-w-4xl h-[80vh] flex flex-col",children:[(0,l.jsxs)("div",{className:"p-4 border-b border-gray-200 flex items-center justify-between",children:[(0,l.jsx)("h3",{className:"text-lg font-medium",children:"Select Image"}),(0,l.jsx)("button",{onClick:()=>D(!1),className:"text-gray-400 hover:text-gray-600",children:"✕"})]}),(0,l.jsx)("div",{className:"flex-1 overflow-hidden",children:(0,l.jsx)(i.b,{onFileSelect:e=>{z&&O(z,{type:"image",content:e.alt||e.name,metadata:{src:e.url,alt:e.alt||e.name}}),D(!1)},allowMultiple:!1,acceptedTypes:["image/*"],showPreview:!0})})]})})]})}}}]);